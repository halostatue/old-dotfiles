# vim: ft=sh

if [ -r /etc/debian_version ]; then
  if has apt-get; then
    function apt-search()
    {
      command apt-cache search "${@}";
    }

    function apt-upgrade()
    {
      if [ -z "${1}" ]; then
        sudo apt-get update
        sudo apt-get -u upgrade
      else
        ssh ${1} sudo apt-get update
        # Ask before the upgrade.
        local answer
        ssh ${1} sudo apt-get --no-act upgrade
        printf "Process the upgrade? "
        read -q answer

        if [[ ${answer} == "y" ]]; then
          ssh ${1} sudo apt-get -u upgrade --yes
        fi
      fi
    }

    function add-key()
    {
      apt-key adv --keyserver keyserver.ubuntu.com --recv-keys ${1}
    }

    function is_ubuntu()
    {
      local DISTRIB_ID DISTRIB_RELEASE DISTRIB_CODENAME DISTRIB_DESCRIPTION
      local -i result=0
      [ -r /etc/lsb-release ] || result=1
      source /etc/lsb-release
      [ ${DISTRIB_ID} = 'Ubuntu' ] || result=1
      return ${result}
    }

    if is_ubuntu; then
      function add-ppa()
      {
        local DISTRIB_ID DISTRIB_RELEASE DISTRIB_CODENAME DISTRIB_DESCRIPTION
        sudo apt-key adv --recv-keys --keyserver keyserver.ubuntu.com ${2}

        source /etc/lsb-release

        echo deb http://ppa.launchpad.net/${1}/ppa/ubuntu ${DISTRIB_CODENAME} main | \
          sudo tee /etc/apt/sources.list.d/${1}-ppa.list
      }
    fi
  fi

  add_paths_after_if /var/lib/gems/1.8/bin
fi

if has gnome-open; then
  function go() { gnome-open "$@" > /dev/null 2>&1 }
fi
